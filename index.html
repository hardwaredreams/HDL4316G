<HTML>
<HEAD>
    <meta http-equiv="Content-Type"
	  content="text/html; charset=utf-8">
    <title>HDL4316G (Grove互換 I2Cアドレス変換ボード)</title>
  </head>

  <body>
  <H1>HDL4316G</H1>
  Grove互換I2Cアドレス変換ボード

  <H2>概要・特徴</H2>
    <ul>
	<li>I2C スレーブデバイスのアドレスを変換するボード</li>
	<li>Grove互換コネクタを採用、中間に挿入するだけで簡単にアドレス変換</li>
	<li>同じアドレスを持つ複数のスレーブデバイスを同じバスで共存可能に</li>
	<li>変換アドレスは、ハードウェアで設定され、ソフトウェア操作は不要</li>
	<li>最大 400KHzの高速モードに対応</li>
	<li>Analog Devices社(旧: LiearTechnology社)製 LTC4316を採用 </li>
    </ul>
    HDL4316Gは、スレーブ側にあるデバイスのアドレスを異なるアドレスに変換します。 ひとつの I2Cバスに接続する
    スレーブデイバスのアドレスが固定されていたり、同時接続した個数が設定可能なアドレス数より多い場合でも
    ひとつの I2Cバスを共有できるようになります。<br />
    変換機能を使用しない場合は、リピータとしても使うことができます。(この場合は、チップ抵抗の付替えが必要になります。)<br />
    <br />

    <table>
	<tr>
	<td><a href="documents/HDL4316G_top.jpg"><img src="documents/HDL4316G_top_s.jpg"></a></td>
	</tr><tr><td align="left"> 写真1 (表面)<br /></td>
	</tr>
	<tr>
	<td><a href="documents/HDL4316G_bottom.jpg"><img src="documents/HDL4316G_bottom_s.jpg"></a></td>
	</tr><tr>
	<td align="left"> 写真2 (裏面)<br /></td>
	</tr>
	<tr>
	<td><a href="documents/HDL4316G_top_back.jpg"><img src="documents/HDL4316G_top_back_s.jpg"></a></td>
	</tr><tr>
	<td align="left"> 写真3 (表面 と 裏面)<br /></td>
	</tr>
	<tr>
	<td><a href="documents/HDL4316G_and_sensor.jpg"><img src="documents/HDL4316G_and_sensor_s.jpg"></a></td>
	</tr><tr><td align="center"> 写真4 (環境センサとの接続例)</td>
	</tr>
    </table>

    <h2>注意事項</h2>
	<ul>
		<li>注) 本品に接続用の Groveケーブルは付属していません。</li>
		<li>注) 本基板にはケース等は付属していません。</li>
		<li>注）本基板を中継することにより、ホスト側からアクセスするときのスレーブ アドレスが変わりますので、ドライバ・デバイスツリーなど ソフトウェアの修正が必要になります。</li>
		<li>注) 本基板で変換の対象になるデバイスアドレスは 7bit modeに限ります。 10bit modeはサポートされていません。</li>
		<li>注) 本基板でゼネラルコールアドレス (0x00) を使用することはできません。ゼネラルコールアドレスも 本基板で変換の対象になるため、CN2側のデバイスへ変換されたアドレスが送信されるためです。</li>
	</ul>
  <H2>主な仕様</H2>

  <H3>ABSOLUTE MAXIMUM RATINS</H3>
	<table border="1">
	<tr>
		<th>項目</th>
		<td>定格</td>
		<td></td>
	</tr>
	<tr>
		<th>入力電源電圧</th>
		<td>-0.3 ～ 6V</td>
		<td>GNDと VDDライン間</td>
	</tr>
	<tr>
		<th>入出力電圧</th>
		<td> -0.3 ～ 6V</td>
		<td>SCL/SDAの入力および出力端子</td>
	</tr>
	<tr>
		<th>動作温度範囲</th>
		<td>0～70度</td>
		<td></td>
	</tr>
	</table>
	上記の範囲を超える状態は、デバイスへの永久的なダメージ・損傷を与える可能性がありますので、
        この範囲を越えないようにしてください。 また、この値は、動作をする範囲ではありません。<br />
                電圧は、 GNDが基準になります。<br />

  <H3>電気的特性</H3>
	<table border="1">
	<tr>
		<th>項目</th>
		<td>定格</td>
		<td>摘要</td>
	</tr>
	<tr>
		<th>電源電圧</th>
		<td>5V (標準)</td>
		<td>ホストデバイス側から入力された 5Vが そのままスレーブデバイス側に供給されます</td>
	</tr>
	<tr>
		<th>消費電流</th>
		<td>0.6 ～ 2mA</td>
		<td>動作時 I2Cバス アイドル時</td>
	</tr>
	<tr>
		<th>SDA/SCL 電圧レベル</th>
		<td>3.3V (標準)</td>
		<td>動作時 I2Cバス アイドル時</td>
	</tr>

	<tr>
		<th>I2C タイミング</th>
		<td>最大 400KHz</td>
		<td></td>
	</tr>
	<tr>
		<th>I2C ホスト側プルアップ抵抗</th>
		<td>未実装</td>
		<td>プルアップ抵抗は、ホスト側で実装してください。<br />
		ホスト側で実装できない場合は、1608サイズのチップ抵抗用実装パッドに実装してください。</td>
	</tr>
	<tr>
		<th>I2C 出力側プルアップ抵抗</th>
		<td aligin="center">10kΩ</td>
		<td>チップ抵抗実装済 (1608サイズ、1/10W)</td>
	</tr>
	<tr>
		<th>基板サイズ</th>
		<td>40 x 15 x 1.2mm</td>
		<td>長さ x 幅 x 厚さ</td>
	</tr>
	<tr>
		<th>重量</th>
		<td aligin="right"> 約3g </td>
		<td></td>
	</tr>
	</table>

  <H2>使い方</H2>
        使い方の詳細については <a href="usage.html">HDL4316G 使い方</a> のページを参照してください。<br />
	基本的な使い方は、本基板の CN1側Grove互換コネクタ側に M5Stackや Raspberry Piなどの I2Cバスにアクセスするコンピュータを
	Groveケーブルで接続します。 CN2側のGrove互換コネクタ側には スレーブアドレスを変換したい I2Cでアクセス可能なセンサや、
	ディスプレイなどのデバイスを Groveケーブルで接続します。 
	なお、Groveケーブルは、本基板には付属していませんので、別途ご用意ください。<br />
	本基板を経由すると ホスト側からは、変換されたアドレスでアクセスできます。 i2cdetect コマンド
	(RaspberryPi OSの場合)などで確認してください。
 
  <H3>本基板の種類</H3>
	本基板は、デバイス側のアドレスを変換する値によって下記の種類を用意しています。変換するアドレスによって選択してください。
	<table border="1">
	<tr>
		<th>型番</th>
		<td>変換アドレス値</td>
		<td>摘要</td>
	</tr>
	<tr>
		<th>HDL4316G-02</th>
		<td align="center">0x02</td>
		<td>0x02と排他論理和されます</td>
	</tr>
	<tr>
		<th>HDL4316G-04</th>
		<td align="center">0x04</td>
		<td>0x04と排他論理和されます</td>
	</tr>
	</table>
	型番の末尾は、基板裏面の CONFIG欄に表示しています。<br />
	型番の末尾は、変換するアドレス値です。今後、種類を追加する場合があります。


  <H3>動作概要</H3>
	HDL4316G 基板に実装されている Analog Devices社製の LTC4316 は、電源が入ると変換するアドレスの設定値を
	読み取って動作を開始します。 設定値は、基板上のチップ抵抗にて設定されます。(この値は 0x00～0x7F の間で設定する
	ことが出来ます)<br />
	LTC4316は、マスタ側から開始されるスタートコンディションを検出すると、スレーブデバイスに向かって送信されるアドレスの
	変換を開始します。
	LTC4316は、マスタ側から送られてくるスレーブデバイスのアドレスを ビット毎に排他的論理和を行い、その結果を スレーブデバイス側に
	送信します。その結果、スレーブデバイス側には、マスタデバイスが送信したアドレスと基板上の設定値の排他的論理和の値が、スレーブ
	デバイスのアドレスとなります。LTC4316は、スレーブデバイスのアドレス変換を行ったあとは、マスタ側、スレーブ側の通信を阻害せずに、
	そのまま中継しますので、アドレスの変換以外に影響はありません。<br />
	例えば、2台のLCDディスプレイが 0x3E というスレーブアドレスを持っていた場合、アドレスが重複しているので 両方のデバイスが
	応答するので、個別に正しく通信ができません。(多くの場合、同じ内容が表示されるでしょう)<br />
	センサだった場合、読み出しを行うときに、2つのセンサからの応答が重複して、どちらのセンサからも正しい値を
	受信することが出来ません。<br />

	そこで、2台のうち、1台だけ異なるアドレスに変換することで、通信の衝突をさけ、正しく通信できるようにします。<br />
	I2Cハブ接続基板などを経由し、1台のデバイスを そのまま接続し、もう1台を 設定値 0x02 に設定された HDL4316G-02 を経由して
	接続します。この場合、ホストデバイスが 0x3E というアドレスを送信すると、そのまま接続されたスレーブデバイスには 0x3E が
	送信され、スレーブデバイスは応答します。
	HDL4316G を経由したデバイスには、0x02 と排他的論理和の結果である 0x3C が送信されてくるので、待ち受けている 0x3E とは、
	異なるために応答しなくなります。<br />
	次に、ホストデバイスが 0x3C というアドレスを送信すると、直接接続されたスレーブデバイスには 0x3C が送信されるため、
	応答しなくなりますが、HDL4316G-02 を経由したデイバスには、排他的論理和の結果である 0x3E が送信されるため、
	このアドレスに応答します。<br />
	この結果、2つのスレーブデバイスは アドレス変換しない 0x3E と アドレス変換された 0x3C を使用するため、1つの I2Cバスで
	2つのスレーブデバイスが共存できるようになります。<br />
	もし、3台以上を共存させるには、変換するアドレスの設定値を変えたものを 並列に接続すればよいことになります。<br />
	この HDL4316G は、チップ抵抗の設定により、アドレスを変更しないパススルーモードもあります。この場合、基板上の LTC4316 が、
	スレーブデバイス側のI2Cバスを駆動するので、リピータとして機能するようになります。
	<br />
	<br />
	変換アドレスを変更するには、基板上のチップ抵抗を交換する必要があります。詳しくは  
        <a href="usage.html">HDL4316G 使い方</a> のページを参照してください。<br />

<br />
	そのほか、動作の詳しい内容については、Analog Devices社から発行されている LTC4316のデータシートを参照してください。
<br />
   <H2>資料など</H2>

 <UL>
   <LI><a href="documents/HDL4316G-schematic.pdf">回路図</a></LI>
      <LI><a href="documents/HDL4316-outline.pdf">基板外形図</a></LI>
      <LI><a href="documents/bomlist.ods">BOMLIST</a></LI>
      <LI><a href="documents/gerber-drill.zip">ガーバー および ドリルリスト・ドリルデータ</a></LI>
   <LI><a href="https://www.analog.com/media/en/technical-documentation/data-sheets/4316fa.pdf">LTC4316 データシート</a>
   (Analog Devices社のサイトにリンクしています)
      </LI>
  </UL>  

   <H2>そのほか</H2>

 <UL>
	<LI>本基板は、RaspberryPi 4 に接続し i2cdetect コマンドにてアドレス変換が機能していることを確認しています。</LI>
	<LI>本基板は、すべて手半田による手作りです。個体によって 半田付けの仕上がりに差がありますので、ご了承ください。</LI>
  </UL>  


	<hr />
	<i>Copyright 2024 (C) By HardwareDreams</i>

  </body>


</HTML>
